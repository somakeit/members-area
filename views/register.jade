extends layout

block body
  - var controlGroupClass, value, item, field
  - var tabIndex = 1
  .row
    .span4.gumph
      h2 Membership
      p So Make It is a members-owned non-profit association. Membership is paid
        | monthly by standing order. We ask that you pay what
        | you think the space is worth to you. Running an organisation like this
        | isn't cheap, so please be as generous as you can. The minimum
        | subscription is £5/month. The space requires our members to contribute an
        | average subscription of £20/month to survive.

      p By joining So Make It you're becoming a member of So Make It Ltd., and you 
        | agree to be bound by our 
        a(href="http://so-make-it.github.com/constitution/") constitution
        | . You also agree to follow the 
        a(href="http://wiki.somakeit.org.uk/wiki/Rules") rules of the space
        | .

      p
        strong
          a(href="http://www.legislation.gov.uk/ukpga/2006/46/part/8/chapter/2/crossheading/general") UK law
          |  requires that you provide your real name and address in order to join.
        |  Your name will be visible to all members.

      p Many of the services provided by So Make It require a username and
        | password, so you will need to choose a unique username.

    .span4.offset2.register-form
      h2 Registration form
      form(action='', method='POST')
        fieldset
          input(type='hidden', name='form', value='register')

          p
            strong
              a(href="http://www.legislation.gov.uk/ukpga/2006/46/part/8/chapter/2/crossheading/general") UK law
              |  requires that you provide your real name and address in order to join.
          - each field in ['Full Name', 'Email', 'Username']
            - item = field.replace(/ /,"").toLowerCase()
            - controlGroupClass = (err && err[item] ? "error" : "")
            .control-group(class=controlGroupClass)
              label(class="text-"+controlGroupClass)= field
              input.text(type='text', name=item, placeholder='Required', value=data[item], tabindex=tabIndex++)

              if item == 'email' && err && err.email409
                p.text-error This email address is already registered.
              if item == 'username' && err && err.username409
                p.text-error This username has been taken by another user.

          - controlGroupClass = (err && err.address ? "error" : "")
          .control-group(class=controlGroupClass)
            label(class="text-"+controlGroupClass) Address
            textarea.text(name='address', placeholder='Required', rows=4, tabindex=tabIndex++)= data.address

          - controlGroupClass = (err && err.password ? "error" : "")
          .control-group(class=controlGroupClass)
            label(class="text-"+controlGroupClass) Password
            input.text(type='password', name='password', placeholder='Password', tabindex=tabIndex++)
            input.text(type='password', name='password2', placeholder='Again', tabindex=tabIndex++)

            if err && err.passwordsdontmatch
              p.text-error Passwords don't match.

          - controlGroupClass = (err && err.wikiname ? "error" : "")
          .control-group(class=controlGroupClass)
            label(class="text-"+controlGroupClass) Wiki Username (if you have one)
            input.text(type='text', name='wikiname', placeholder='Optional', value=data.wikiname, tabindex=tabIndex++)

          - controlGroupClass = (err && err.terms ? "error" : "")
          .control-group(class=controlGroupClass)
            label(class="text-"+controlGroupClass)
              input(type="checkbox", name="terms", tabindex=tabIndex++)
              |  I agree to be bound by the So Make It 
              a(href="http://so-make-it.github.com/constitution/") constitution
              |  and 
              a(href="http://wiki.somakeit.org.uk/wiki/Rules") rules
              |.

          if err && err.unknown
            p.text-error An unknown error occurred. Please contact 
              a(href="mailto:benjie@somakeit.org.uk?subject=Signup%20Issue") Benjie
              | .

          button.btn.btn-primary.btn-large(type='submit', tabindex=tabIndex++) Sign up

